---
layout: post
title: "侧链（Sidechain）白皮书笔记"
description: ""
category: articles
tags: [Blockchain]
comments: true
---

## 简介

#### 比特币的局限性讨论

1. 在可扩展性和去中心化间的取舍。

    > 例如，更大的区块可以支持更高的交易速率，代价是加大了验证方的工作量——中心化的风险。

    > 同样，在安全性和成本之间也存在取舍。比特币历史记录中用同等级别的不可逆性存储了每一笔交易。这种方式的维护代价很高，对低价值和低风险的交易来说也未必合适(例如，所有参与方已经商定了一个共同的法律机构来处理欺诈行为)。

    > 由于不同交易的价值和风险状况有很大的不同，这样的取舍应当针对每笔交易来应用。然而比特币系统的构建仅支持以一个标准来应对所有问题。

2. 在区块链的功能上存在更多的取舍。

    > 例如，是让比特币的脚本更强大来支持简明和有用的合约，还是减少功能以便于审计。

3. 一些非货币的资产也可以在区块链上交易

    > 例如欠条、其它合约和智能财产。

4. 存在一元化育成的风险:比特币系统由许多密码学组件构成，其中的任何一个组件出问题，都会导致整体价值的损失。

    > 如果有可能，不要用同一套算法来保护每个比特币会更谨慎些。

5. 新技术可能会带来比特币系统创建初期没有想到的新功能。

    > 例如，用加密累加器、环签名或 `Chaumian` 盲签名来增强隐私保护和抗审查性。

6. 即使有这样做的迫切需求，但没有对比特币系统安全升级的途径，这意味着任何更改都需要所有参与者协同执行才能生效。比特币的开发者们之间达成了一个共识，对比特币系统的变更必须缓慢、谨慎，且仅当社区有明确同意时才进行。

#### 侧链的产生

竞争链(altchains)的问题：

问题一 基础架构碎片化

由于每个竞争链都使用自己的技术堆叠，经常会有重复性或遗失的工作。因此，由于竞争链的实现，可能并未扫除比特币系统中安全特定领域知识的障碍，安全问题常常跨竞争链被复制，而它们的修复也不解决这些问题。必须消耗大量资源或是建立专家评价评审新的分布式加密系统，如果没这样做，安全隐患常常无法察觉，直到漏洞被利用。结果是，我们看到了一种动荡的、无法前航的发展环境，大部分显现出来的项目可能在技术上是最不健全的。打个比方，想象一下在互联网上，每个网站使用自已的TCP实现将自定义的检验和数据包拼接算法广播给最终用户。这不会是一个能生存的环境，这也不是竞争链能生存的环境。

问题二

这样的竞争链和比特币系统一样，通常有自己的带有浮动价格的原生加密货币，或称竞争币。为了使用竞争链，用户需要通过一个市场来获取这种货币，这将使他们直接面对新货币带来的高风险和波动。此外，因为有独立解决初始分配和估值问题的需求，与此同时还要在不良的网络效应与拥挤的市场中竞争，这既阻碍了技术创新，又助长了市场的博弈。这危及的不仅仅是这些系统的直接参与者，还危及到整个加密货币行业。如果这一领域被公众认为风险过高，对加密货币的采纳可能会受阻，或者有可能完全被遗弃(自愿或立法上)。

这表明我们希望有一个环境来让可互操作的竞争链能易于创建和使用，但不要产生不必要的市场和开发碎片。在本文中，我们认为这些看似矛盾的目标有可能同时实现。核心考察点是 Bitcoin 这一区块链在概念上是独立于 bitcoin 这一资产：如果我们能在技术上支持区块链间资产的移动，可以通过简单地复用现有比特币的方式，开发出用户可能会采纳的新系统。

#### 楔入式侧链

特性：

1. 在侧链间移动的资产应当能够被当前持有者移回，但除此之外的任何人则不行(包括前持有者)。

2. 资产的移动应当无交易对手风险；也就是说，不诚实的一方无法阻止转移的发生。

3. 资产转移应当是元操作(原子操作)，即，要么完全完成，要么根本不发生。不应存在会导致资产损失或允许欺诈产生的失败模式。

4. 侧链应当设有防火墙：一个会使某条链发生资产铸造(或偷盗)的缺陷(bug)，不应导致任何其他链出现资产的铸造或偷盗。

5 。区块链重组时应当处理干净，即使在资产转移的期间也要如此;任何破坏应当只发生在它所处的侧链上。总的来说，理想情况下，侧链应当完全独立，自其他链上的全部所需数据由用户提供来。侧链的验证者应当只有在侧链本身的显式共识规则有要求时，才需要跟踪其他链。

6. 不应要求用户去跟踪他们未主动使用的侧链。

早期“转移”钱币的解决方案是用一个可公开识别的方式来销毁比特币，让新的区块链能检测到，以允许铸造新币。这解决了部分上面提到的问题，但由于这种方法只允许单向转移，因此还不足以满足我们的目的。

我们提出的方案是由资产转移的交易本身提供所有者证明来转移资产，避免让节点有跟踪发送方链的需求。从上层实现角度，当资产从一个区块链向另一个链移动时，我们在第一个区块链上创建交易锁定资产，然后在第二个区块链上创建一笔交易，该交易的输入中包含一个锁定已正确完成的密码学证明。这些输入用某种资产类型来标记，比如创生出资产的区块链的创世哈希(genesis hash)。

第一个区块链我们称之为父链，每二个则简单称为侧链。在某些模型中，两条链可对称地来处理，因此这一术语应当看成是相对的。从概念上讲，我们打算将资产从(初始)父链转移到一条侧链，可能会再转移到别的侧链，最终还能转回至父链，并保全初始资产。一般我们把父链看成是比特币系统，侧链是其他区块链中的某一个。当然，侧链的币(coin)也可以在侧链间传递，并非只能与比特币系统进行往来;不过，由于任何一个最初从比特币系统移动的币都可以移回去，所以不管变成什么样，它仍是个比特币。

这让我们解决了前面章节提到的碎片化问题，对只想专注于技术创新的开发者来说是个好消息。

此外，由于侧链是从父链中转移现有资产而不是另铸新资产，侧链不会引起未经授权的铸币，维护资产的安全和稀缺性依靠父链来实现。

更进一步说，参与者不必再担心他们的持有物会被一个实验性竞争链锁往，因为侧链币能够用等额的父链币来赎回。这提供了一个退出机制，减少因软件无人维护而造成的损失。

另一方面，由于侧链还是一个独立于比特币系统的区块链，它们可以自由地尝试新的交易设计、信任模型、经济模型、资产发行语义，或加密特性。我们将在第5节中进一步探讨一些侧链的可能性。

这一基础架构的额外好处是对比特币系统本身进行改变不再那么迫切：与其策划一个需要各方均达成一致并一起实施的分叉，不如用侧链来创建一个新的“改变了的比特币系统”。从中期看，如果广泛认可新系统有进步，最终会明显看到，相对于比特币父链，更多的人会使用这个新系统。由于父链的规则没有任何修改，任何人都可以根据自己的时间去切换，不会有任何因共识失败所带来的风险。从长期看，如果父链被认为，或当父链需要改变时，侧链的成功将给父链的更改提供了所需的信心。

## 设计原理

“无需信任”指的不依赖外部的可信方也可完成正确的操作的特性，一般是能够让所有参与方自己验证信息是否正确。例如，密码学签名系统中，“无需信任”是一个隐式的必要条件(如果攻击者能伪造签名，那么这个签名系统将被视为被完全破解)。虽然分布式系统中一般不需如此，但比特币在系统的大部分中提供了“无信任”操作。

“楔入式侧链”的一个主要目标是在比特币系统模型之上最小化附加的信任。难点是币在侧链间的安全转移：接收链必须能得知发送链的币已被正确锁定。在比特币的领导下，我们提议用 DMMS 来解决这一问题。尽管有可能利用一个简单基于信任的方案，引入固定数量签名者来验证币的锁定，但有很多重要理由让我们避免这种单点故障的引入：

- 信任个人签名者，并不仅仅意味期待他们做事诚实，他们还必须永远不出漏洞、永远不会泄露关键的秘密、永远不会被挟持、永远不会停止参与网络。

- 由于数字签名是长期存在的，对任何信任的要求也必须如此。经验告诉我们，即使时间跨度只有几个月，信任需求也是一种危险的期待，更何况我们所期望的金融系统所能持续的时间长达几个世代。

- 在比特币系统消除了单点故障前，数字货币一直没有什么吸引力，社区强烈反对引入这种弱点。2007年以来的金融事件更加强了社区的不信任;对金融系统和其他公共机构的公共信任也同样处于历史的低点。

#### 双向楔入

楔入式侧链的技术基础称作双向楔入。本节我们将解释它是如何工作的，先给出一些定义。

定义：

- 币(coin)，或资产，是一种可以用密码学方法辨识控制者的数字财产。

- 区块，是一个描述资产控制发生变化的交易的集合。

- 区块链，是一个有序次的区块的集合，所有用户必须(或最终)对该集合达成共识。这确定了资产控制的历史，提供了一个计算上无法伪造的交易时序。

- 重组，或称 reorg，发生在客户端本地，当先前已接受的链被一个有更多工作量证明的竞争链取代时，分叉上失败一方的区块要从共识历史中移除。

- 侧链，是验证来自其他区块链数据的区块链。

- 双向楔入，指的是让币以一个固定或确定性的汇率在侧链间转出和转入的机制。

- 楔入式侧链，是一条资产可以从其他链导入并返还的侧链；即，一条支持双向楔入资产的侧链。

- 简单支付验证证明(或称 SPV 证明)，是一种动态成员多方签名(DMMS)，发生于一条类比特币系统工作量证明(proof-of-work)区块链上。

本质上，SPV 是由(a)一系列展示工作量证明的区块头，和(b)一份加密证明（可证明输出创建于其中某一区块）所组成。

这使验证者可以检查是否有一定数量的工作已经认可了某个输出的存在。当有其他证明(proof)展示了一条工作量更多的链，且生成该输出区块未包含于其中时，其他证明会使这一证明失效。

使用 SPV 证明来确定交易历史，隐含着要信任最长的区块链也是最长的正确区块链，在比特币系统中，这是由一个被称为 SPV 的客户端实现的。由于诚实的哈希算力不会为一个无效链去工作，只有当超过 50% 的哈希算力合谋时，才会始终欺骗 SPV 客户端(除非客户端处于长期的恶意攻击之下，使其无法看到实际的最长链)。

还可以这样做，通过获取每个区块头来指代区块链上未花费输出的集合，任何拥有 SPV 证明的人不需要下载每个区块也能确定链的状态。(在比特币系统中，完全验证节点第一次开始跟踪区块链时需要做这种数据下载。)

通过在比特币系统的区块结构中包含一些额外数据，我们可以生成比区块头完整列表更小的证明(proofs)，从而提高可扩展性。尽管如此，这样的证明还是比普通的比特币交易要大得多。幸好对于大多数资产转移来说，这并不是必要的：每条链的持币人可以直接使用元互换(原子交换)操作进行汇兑。

#### 对称式双向楔入

我们可以利用这些想法将一个侧链 SPV 楔入至另一个侧链。这包含以下工作：为了将父链币转移为侧链币，父链币被发送到父链上的一个特殊输出中，该输出只能由侧链上拥有的一个 SPV 证明来解锁。为了在两条链上进行同步，我们需要定义两个等待周期：






