---
layout: post
title: "Core ML（一）——初体验"
description: ""
category: articles
tags: [Machine Learning]
comments: true
---


> Core ML lets you integrate a broad variety of machine learning model types into your app. In addition to supporting extensive deep learning with over 30 layer types, it also supports standard models such as tree ensembles, SVMs, and generalized linear models. Because it’s built on top of low level technologies like Metal and Accelerate, Core ML seamlessly takes advantage of the CPU and GPU to provide maximum performance and efficiency. You can run machine learning models on the device so data doesn't need to leave the device to be analyzed.

> -[Apple's Machine Learning Overview](https://developer.apple.com/machine-learning/)

苹果在 WWDC 2017 上除了 ARKit 之外还推出了另外一个万众瞩目的框架——Core ML。通过这个框架我们可以轻易地为 App 添加机器学习（Machine Learning）的功能。轻易到什么程度？写一个图像识别的 App 来体验下吧。

在此之前我也没有深入过解过神经网络（Neural Network）以及机器学习（Machine Learning）的知识。模型也是从[这里](https://coreml.store/)下载的。

我是谁？我在哪？什么是 Machine Learning？道理我都不懂，但是还是做了一个高大上的 Machine Learning App。

## 关于 Machine Learning

首先我们要简单了解下机器学习（Machine Learning）。机器学习常见定义：[机器学习](https://zh.wikipedia.org/wiki/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0)是一门人工智能的科学，该领域的主要研究对象是人工智能，特别是如何在经验学习中改善具体算法的性能。经验学习的过程就是“训练”，而经验学习的所获得的“知识”，可以称之为“模型”。训练和建立模型的方法和过程比较复杂，但目前我们的目标是先使用模型构建有意思的 App，而且，通过 Apple 的 Core ML，可以让构建过程更轻松。

## App 功能概述

App 的名字为 Pixabay4ML，主要是使用 Core ML 框架，通过模型来识别从 [pixabay](https://pixabay.com/) 随机下载的一张图片的内容。运气好的话，说不定可以加载到一张美女的图片哦。

## 创建项目

创建过程没有什么特别的，主要用到的 pod 库为：

```ruby
  pod 'Alamofire',    '4.6.0'  #用于网络请求
  pod 'Fuzi',         '2.0.1'  #用于解析 html
  pod 'Kingfisher',   '4.5.0'  #用于加载图片
```

UI 界面的搭建没什么难度，顺便熟悉下 Swift 语法。

## 整合 Core ML Data 模型

接下来需要集成 Core ML 模型到我们的项目中。这里我们使用 Apple 提供的 [Inception v3 模型](https://docs-assets.developer.apple.com/coreml/models/Inceptionv3.mlmodel)。下载完成后加到项目中，可以查看模型的基础信息。

![01](https://lettleprince.github.io/images/20171206-coreml-01/01.png)

可以看到 inputs 和 outputs 的类型。输入为 299×299 的图像，输出为字典和字符串，描述最可能的分类和可能性。





### 参考：

[Apple - Core ML](https://developer.apple.com/documentation/coreml)

[Introduction to Core ML: Building a Simple Image Recognition App](https://www.appcoda.com/coreml-introduction/)


### 代码：
文章中的代码都可以从我的GitHub [`ARKitDemo`](https://github.com/lettleprince/ARKitDemo)找到。

