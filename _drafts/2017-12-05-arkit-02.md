---
layout: post
title: "ARKit（二）——核心类介绍"
description: ""
category: articles
tags: [ARKit]
comments: true
---


## 核心类介绍

[`ARSCNView`](https://developer.apple.com/documentation/arkit/arscnview)：辅助视图，主要功能是将 SceneKit 渲染的 3D 内容渲染到相机的实时图像上，从而实现 AR 体验的视图。ARSCNView 继承于 <SceneKit> 框架中的 SCNView,而 SCNView 又继承于 <UIKit> 框架中的 UIView。这个类主要做了以下的事情：

- 从设备相机中取到实时的画面，并渲染到 3D 场景中作为背景。

- ARKit 的三维坐标系可以与 SceneKit 的三维坐标系进行匹配。因此，在这个视图中渲染出的对象能够自动匹配到 ARKit 的世界坐标。

- 自动移动虚拟的 SceneKit 相机去匹配在真实世界中的由 ARKit 跟踪的 3D 坐标，因此我们不需要写代码来将移动事件与 SceneKit 的 3D 图像进行关联。

由于 ARKit 会自动将 SceneKit 空间与真实世界相匹配，所以要放置一个虚拟物品让它显示在真实世界的位置上，只需要给它设置一个合适的 SceneKit 坐标即可。我们并不需要使用 ARAnchor 类去追踪你添加在场景中的物体的坐标，但是还是需要实现 ARSCNViewDelegate 中的方法，这样才可以在 ARKit 自动检测的任何一个锚点上添加 SceneKit 的内容。

需要注意的是：渲染 3D 物体的功能是父类 SCNView 就具备的功能，而捕捉 3D 现实场景并进行相应坐标计算转换的是 ARSCNView（也就是 ARKit）的实现的功能。

[`ARSession`](https://developer.apple.com/documentation/arkit/arsession)：每个用 ARKit 建立的 AR 场景都需要一个 ARSession 对象。它负责控制相机，从设备中收集所有的传感器数据（包括从设备的运动传感器中读取数据，控制设备的相机，对相机中捕获到的图像进行分析），来建立用户所在的现实世界与 AR 模型的内容空间之间的联系。ARSCNView 实例已经包含一个 ARSession 实例，只需要在启动的时候进行配置（`ARSessionConfiguration` 或其子类 `ARWorldTrackingSessionConfiguration`）就可以了。

[`ARWorldTrackingSessionConfiguration `](https://developer.apple.com/documentation/arkit/arworldtrackingsessionconfiguration)：这个类可以在 6 个自由维度上(six degrees of freedom, 6DOF)追踪设备的移动, 也就是 3 个旋转轴（roll：绕着垂直于手机屏幕的轴旋转，yaw：绕着手机的向上方向旋转，pitch：改变手机的俯仰），3 个平移轴（在 x, y, z 上的移动）。这样我们可以围绕虚拟物体进行查看，设置可以移动虚拟物体。如果没有这样的需求，并且用户并不会在虚拟体验中改变位置，那可以使用 ARSessionConfiguration 来初始化 ARSession 实例。

### 参考：

[Apple ARKit by Example](https://blog.markdaws.net/arkit-by-example-part1-7830677ef84d)


### 代码：
文章中的代码都可以从我的GitHub [`ARKitDemo`](https://github.com/lettleprince/ARKitDemo)找到。

